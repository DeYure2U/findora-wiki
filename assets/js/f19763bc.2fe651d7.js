(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[857],{4093:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return d},default:function(){return m}});var a=t(2122),o=t(9756),r=(t(7294),t(3905)),l=["components"],i={sidebar_position:3},s="Run a validator node in findora testnet",u={unversionedId:"general/run-a-testnet-validator-node",id:"general/run-a-testnet-validator-node",isDocsHomePage:!1,title:"Run a validator node in findora testnet",description:"This document shows:",source:"@site/docs/general/run-a-testnet-validator-node.md",sourceDirName:"general",slug:"/general/run-a-testnet-validator-node",permalink:"/findora-wiki/docs/general/run-a-testnet-validator-node",editUrl:"https://github.com/FindoraNetwork/findora-wiki/edit/main/docs/general/run-a-testnet-validator-node.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Run a Findora Full Node",permalink:"/findora-wiki/docs/general/run-a-mainnet-validator-node"}},d=[{value:"Preparatory work",id:"preparatory-work",children:[{value:"Obtain the necessary binaries",id:"obtain-the-necessary-binaries",children:[]},{value:"Configure your local node",id:"configure-your-local-node",children:[]}]},{value:"Staking",id:"staking",children:[{value:"Stake into findora network",id:"stake-into-findora-network",children:[]},{value:"Append more power to your node",id:"append-more-power-to-your-node",children:[]},{value:"Query infomations",id:"query-infomations",children:[]},{value:"Claim rewards",id:"claim-rewards",children:[]},{value:"Unstake principals",id:"unstake-principals",children:[]}]}],p={toc:d};function m(e){var n=e.components,i=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},p,i,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"run-a-validator-node-in-findora-testnet"},"Run a validator node in findora testnet"),(0,r.kt)("p",null,"This document shows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"How to add your own node to the findora network (testnet)"),(0,r.kt)("li",{parentName:"ul"},"How to make your node one of the candidate validators by staking")),(0,r.kt)("h2",{id:"preparatory-work"},"Preparatory work"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("p",{parentName:"blockquote"},"If you want to skip this stage and experience the staking operations directly, you can execute this automated script: ",(0,r.kt)("a",{target:"_blank",href:t(1804).Z},(0,r.kt)("strong",null,"node_init.sh")),"."),(0,r.kt)("p",{parentName:"blockquote"},"example: ",(0,r.kt)("inlineCode",{parentName:"p"},"bash -x node_init.sh"))),(0,r.kt)("h3",{id:"obtain-the-necessary-binaries"},"Obtain the necessary binaries"),(0,r.kt)("p",null,"You can get them by downloading or compiling by yourself, we will use the downloading method in this document."),(0,r.kt)("p",null,"The required binaries are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"tendermint"),": a findora version of tendermint-core node",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/tendermint"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/tendermint"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"abci_validtor_node"),": the abci node of findora network",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/abci_validator_node"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/abci_validator_node"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns"),": a command line tool for staking",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/fns"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/fns"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"stt"),": an optional auxiliary tool for staking",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/stt"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/stt"},"MacOS version"))))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"'Running a node on Windows' has not been supported yet"),(0,r.kt)("li",{parentName:"ul"},"You should give proper executable permissions to these downloaded binaries",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Example: ",(0,r.kt)("inlineCode",{parentName:"li"},"chmod +x tendermint abci_validator_node fns stt")))),(0,r.kt)("li",{parentName:"ul"},"You should also move these binaries to one of your ",(0,r.kt)("inlineCode",{parentName:"li"},"PATH")," directories",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Example: ",(0,r.kt)("inlineCode",{parentName:"li"},"mv tendermint abci_validator_node fns stt /usr/local/bin/")))))),(0,r.kt)("h3",{id:"configure-your-local-node"},"Configure your local node"),(0,r.kt)("h4",{id:"set-necessary-environment-variables"},"Set necessary environment variables"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# example:\n#     export LEDGER_DIR=${HOME}/findora_testnet\nexport LEDGER_DIR=<The path where you want to store your ledger data>\n\n# example:\n#     export TENDERMINT_NODE_KEY_CONFIG_PATH=${HOME}/.tendermint/config/priv_validator_key.json\nexport TENDERMINT_NODE_KEY_CONFIG_PATH=<The path where the 'priv_validator_key.json' are stored>\n\n# Optional, only if you want to query from your locale node\nexport ENABLE_LEDGER_SERVICE=true\n\n# Optional, only if you want to query from your locale node\nexport ENABLE_QUERY_SERVICE=true\n")),(0,r.kt)("h4",{id:"generate-key"},"Generate key"),(0,r.kt)("p",null,"Generate a new random key for your node:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns genkey\n")),(0,r.kt)("p",null,"Output example (please do not use this sample directly):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Mnemonic: repair drink action brass term blur fat doll spoon thumb raise squirrel tornado engine tumble picnic approve elegant tube urge ghost secret seminar blame\nKey: {\n  "pub_key": "LSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=",\n  "sec_key": "b0MGhK7xaRQHuhzFkaBhQ1o4GwTumJEWt1NQ7FChNwA="\n}\n')),(0,r.kt)("p",null,"set them:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'fns setup -S https://prod-testnet.prod.findora.org\n\n# example:\n#     echo "repair drink action brass term blur fat doll spoon thumb raise squirrel tornado engine tumble picnic approve elegant tube urge ghost secret seminar blame" > ${LEDGER_DIR}/node.mnemonic\n#     fns setup -O ${LEDGER_DIR}/node.mnemonic\nfns setup -O <Path to the mnemonic of your node> || exit 1\n# example \n#     fns setup -K ~/.tendermint/config/priv_validator_key.json \nfns setup -K <path to validator key> || exit 1\n')),(0,r.kt)("h4",{id:"get-fra-tokens"},"Get FRA tokens"),(0,r.kt)("p",null,"Issue and transfer enough FRAs to your address (you should buy them in the real world):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# add new FRAs to findora testnet\nstt issue\n\n# transfer some FRAs to your address\n# example:\n#     stt transfer -f root -t 'LSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=' -n $((10000 * 10000 * 1000000))\nstt transfer -f root -t <the public key of your node> -n <amount>\n")),(0,r.kt)("p",null,"Check the result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns show\n")),(0,r.kt)("p",null,"Output example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Server URL:\nhttps://prod-testnet.prod.findora.org\n\nXfrPublicKey:\nLSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=\n\nYour Balance:\n100000000000000 FRA units\n")),(0,r.kt)("p",null,"If the '",(0,r.kt)("strong",{parentName:"p"},"Your Balance"),"' field is correct, then you can continue."),(0,r.kt)("h4",{id:"custom-the-config-of-your-tendermint-core-node"},"Custom the config of your tendermint-core node"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"you should set up a cluster instead of using a raw node in your production environment"),(0,r.kt)("li",{parentName:"ul"},"cmdline tools like 'wget', 'curl', 'jq' and 'perl' should be installed in advance"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'# Clean up old data that may exist\nrm -rf ~/.tendermint\n\n# Initialize the config of your tendermint node\ntendermint init\n\n# Get the genesis config from an existing node of the testnet\ncurl https://prod-testnet.prod.findora.org:26657/genesis \\\n    | jq -c \\\n    | perl -pe \'s/^{"jsonrpc":"2.0","id":-1,"result":{"genesis"://\' \\\n    | perl -pe \'s/}}$//\' \\\n    | jq > ~/.tendermint/config/genesis.json\n\n# Adjust the block interval\nperl -pi -e \'s#(create_empty_blocks_interval = ).*#$1"15s"#\' ~/.tendermint/config/config.toml\n\n# Config some existing nodes to your locale node, so it can connect to the testnet\nperl -pi -e \\\n    \'s#(persistent_peers = )".*"#$1"b87304454c0a0a0c5ed6c483ac5adc487f3b21f6\\@prod-testnet-us-west-2-sentry-000-public.prod.findora.org:26656"#\' \\\n    ~/.tendermint/config/config.toml\n')),(0,r.kt)("h4",{id:"run-your-locale-node"},"Run your locale node"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# example:\n#     rm -rf ${LEDGER_DIR}\n#     mkdir -p ${LEDGER_DIR}/{abci,tendermint}\n\n# example:\n#     cd ${LEDGER_DIR}/abci\ncd <The running path of your abci process>\nnohup abci_validator_node &\n\n# example:\n#     cd ${LEDGER_DIR}/tendermint \ncd <The running path of your tendermint process>\nnohup tendermint node &\n")),(0,r.kt)("h4",{id:"check-the-status-of-your-locale-node"},"Check the status of your locale node"),(0,r.kt)("p",null,"If the following commands can return useful message without error, then your node is running well:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl 'http://localhost:26657/status'\ncurl 'http://localhost:8669/version'\ncurl 'http://localhost:8668/version' # Only if you set the 'ENABLE_LEDGER_SERVICE'\ncurl 'http://localhost:8667/version' # Only if you set the 'ENABLE_QUERY_SERVICE'\n")),(0,r.kt)("h2",{id:"staking"},"Staking"),(0,r.kt)("p",null,"For staking operations, you should use the ",(0,r.kt)("inlineCode",{parentName:"p"},"fns")," tool."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Usage example:"),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("inlineCode",{parentName:"p"},"fns stake --help")),(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"USAGE:\n    fns stake [FLAGS] [OPTIONS] --amount <Amount>\n\nFLAGS:\n    -a, --append     stake more FRAs to your node\n\nOPTIONS:\n    -n, --amount <Amount>           how much `FRA unit`s you want to stake\n    -R, --commission-rate <Rate>    the commission rate for delegators, a float number from 0.0 to 1.0\n    -M, --validator-memo <Memo>     the description of your validator node, optional\n")),(0,r.kt)("p",{parentName:"blockquote"},"Similar help information can be obtained through the ",(0,r.kt)("inlineCode",{parentName:"p"},"fns")," tool itself:"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns stake --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns unstake --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns claim --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns transfer --help")),(0,r.kt)("li",{parentName:"ul"},"..."))),(0,r.kt)("h3",{id:"stake-into-findora-network"},"Stake into findora network"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"you should wait for 100% completion of the data synchronization of your node",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Or you may be punished by the network because of 'validator node offline'"))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# The minimal amount of FRAs for a successful staking is 888888\n# example:\n# - your want to stake 1888888 FRAs\n# - that is 1888888 * 1000000 FRA units\nfns stake -n $((1888888 * 1000000)) -R 0.2 -M 'Node-A'\n")),(0,r.kt)("h3",{id:"append-more-power-to-your-node"},"Append more power to your node"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# append 2 FRA units to your node,\n# the power of your node will be increased by 2 if all is well\nfns stake -a -n 2\n")),(0,r.kt)("h3",{id:"query-infomations"},"Query infomations"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"fns show\n")),(0,r.kt)("h3",{id:"claim-rewards"},"Claim rewards"),(0,r.kt)("p",null,"Claim all your rewards:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns claim\n")),(0,r.kt)("p",null,"Claim part of your rewards:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# fns claim -n <the amount of FRA units you want>\n# example:\n# - your want to claim 10 FRAs\n# - that is 10 * 1000000 FRA units\nfns claim -n $((10 * 1000000))\n")),(0,r.kt)("h3",{id:"unstake-principals"},"Unstake principals"),(0,r.kt)("p",null,"Unstake all your principals:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"NOTE"),": this operation will make your node out of findora network (testnet).")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns unstake\n")),(0,r.kt)("p",null,"Unstake part of your principals:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# fns unstake -n <the amount of FRA units you want>\n# example:\n# - your want to unstake 900 FRAs\n# - that is 900 * 1000000 FRA units\nfns unstake -n $((900 * 1000000))\n")))}m.isMDXComponent=!0},1804:function(e,n,t){"use strict";n.Z=t.p+"assets/files/node_init-89f81d7811f1ec96402a2946529b6ac1.sh"}}]);