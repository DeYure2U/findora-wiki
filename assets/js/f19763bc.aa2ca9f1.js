(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[857],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=u(n),m=o,k=c["".concat(s,".").concat(m)]||c[m]||p[m]||r;return n?a.createElement(k,l(l({ref:t},d),{},{components:n})):a.createElement(k,l({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=c;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var u=2;u<r;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4093:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return d},default:function(){return c}});var a=n(2122),o=n(9756),r=(n(7294),n(3905)),l=["components"],i={sidebar_position:3},s="How to run a validator node of findora testnet ?",u={unversionedId:"general/run-a-testnet-validator-node",id:"general/run-a-testnet-validator-node",isDocsHomePage:!1,title:"How to run a validator node of findora testnet ?",description:"This document shows:",source:"@site/docs/general/run-a-testnet-validator-node.md",sourceDirName:"general",slug:"/general/run-a-testnet-validator-node",permalink:"/findora-wiki/docs/general/run-a-testnet-validator-node",editUrl:"https://github.com/FindoraNetwork/findora-wiki/edit/main/docs/general/run-a-testnet-validator-node.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Run a Findora Full Node",permalink:"/findora-wiki/docs/general/run-a-mainnet-validator-node"},next:{title:"Create a Page",permalink:"/findora-wiki/docs/tutorial-basics/create-a-page"}},d=[{value:"Preparatory work",id:"preparatory-work",children:[{value:"Obtain the necessary binaries",id:"obtain-the-necessary-binaries",children:[]},{value:"Configure your local node",id:"configure-your-local-node",children:[]}]},{value:"Staking",id:"staking",children:[{value:"Stake into findora network",id:"stake-into-findora-network",children:[]},{value:"Append more power to your node",id:"append-more-power-to-your-node",children:[]},{value:"Query infomations",id:"query-infomations",children:[]},{value:"Claim rewards",id:"claim-rewards",children:[]},{value:"Unstake principals",id:"unstake-principals",children:[]}]}],p={toc:d};function c(e){var t=e.components,n=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-run-a-validator-node-of-findora-testnet-"},"How to run a validator node of findora testnet ?"),(0,r.kt)("p",null,"This document shows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"How to add your own node to the findora network"),(0,r.kt)("li",{parentName:"ul"},"How to make your node one of the candidate validators by staking")),(0,r.kt)("h2",{id:"preparatory-work"},"Preparatory work"),(0,r.kt)("h3",{id:"obtain-the-necessary-binaries"},"Obtain the necessary binaries"),(0,r.kt)("p",null,"You can get them by downloading or compiling by yourself, we will use the downloading method in this document."),(0,r.kt)("p",null,"The required binary files are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"tendermint"),": a findora version of tendermint-core node",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/tendermint"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/tendermint"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"abci_validtor_node"),": the abci node of findora network",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/abci_validator_node"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/abci_validator_node"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns"),": command line tool for staking",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/fns"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/fns"},"MacOS version")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"stt"),": optional auxiliary tools for staking",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/linux/stt"},"Linux version")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/FindoraNetwork/downloads/releases/download/macos/stt"},"MacOS version"))))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"'running a node on Windows' has not been supported yet."),(0,r.kt)("li",{parentName:"ul"},"you should give proper executable permissions to these downloaded binaries",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"like this: ",(0,r.kt)("inlineCode",{parentName:"li"},"chmod +x tendermint abci_validator_node fns stt")))),(0,r.kt)("li",{parentName:"ul"},"you should move these binaries to one of your ",(0,r.kt)("inlineCode",{parentName:"li"},"PATH")," directories as well",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"example: ",(0,r.kt)("inlineCode",{parentName:"li"},"mv tendermint abci_validator_node fns stt /usr/local/bin")))))),(0,r.kt)("h3",{id:"configure-your-local-node"},"Configure your local node"),(0,r.kt)("h4",{id:"generate-key"},"Generate key"),(0,r.kt)("p",null,"Generate a new random key for your node:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns genkey\n")),(0,r.kt)("p",null,"Output example (you should not use this output directly):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Mnemonic: repair drink action brass term blur fat doll spoon thumb raise squirrel tornado engine tumble picnic approve elegant tube urge ghost secret seminar blame\nKey: {\n  "pub_key": "LSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=",\n  "sec_key": "b0MGhK7xaRQHuhzFkaBhQ1o4GwTumJEWt1NQ7FChNwA="\n}\n')),(0,r.kt)("h4",{id:"get-fra-tokens"},"Get FRA tokens"),(0,r.kt)("p",null,"Issue and transfer enough FRAs to your address (you should buy them in the real world):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# add new FRAs to findora testnet\nstt issue\n\n# transfer some FRAs to your address\n# example:\n# stt transfer -f root -t 'LSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=' -n $((10000 * 10000 * 1000000))\nstt transfer -f root -t <the public key of your node> -n <amount>\n")),(0,r.kt)("p",null,"Check the result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns show\n")),(0,r.kt)("p",null,"Output example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Server URL:\nhttps://prod-testnet.prod.findora.org\n\nXfrPublicKey:\nLSlwyUYVg1zBtCqOS6wv_49uHTYS2OwQLBn3bRjrtPU=\n\nYour Balance:\n20999999999990000 FRA units\n")),(0,r.kt)("p",null,"If the '",(0,r.kt)("strong",{parentName:"p"},"Your Balance"),"' field is correct, then you can continue."),(0,r.kt)("h4",{id:"set-the-necessary-environment-variables"},"Set the necessary environment variables"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# example:\n# export LEDGER_DIR=${HOME}/findora_testnet\nexport LEDGER_DIR=<The path where you want to store your ledger data>\n\n# example:\n# export TENDERMINT_NODE_KEY_CONFIG_PATH=${HOME}/.tendermint/config/priv_validator_key.json\nexport TENDERMINT_NODE_KEY_CONFIG_PATH=<The path where the 'priv_validator_key.json' are stored>\n\n# Optional, only if you want to query from your locale node\nexport ENABLE_LEDGER_SERVICE=true\n\n# Optional, only if you want to query from your locale node\nexport ENABLE_QUERY_SERVICE=true\n")),(0,r.kt)("h4",{id:"custom-the-config-of-your-tendermint-core-node"},"Custom the config of your tendermint-core node"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"you should set up a cluster instead of a raw node in production environment"),(0,r.kt)("li",{parentName:"ul"},"cmdline tools(curl/jq/perl) should be installed in advance"))),(0,r.kt)("h1",{id:"clean-up-old-data-that-may-exist"},"Clean up old data that may exist"),(0,r.kt)("p",null,"rm -rf ${HOME}/findora_testnet ~/.tendermint"),(0,r.kt)("h1",{id:"initialize-the-config-of-your-tendermint-node"},"Initialize the config of your tendermint node"),(0,r.kt)("p",null,"tendermint init"),(0,r.kt)("h1",{id:"get-the-genesis-config-from-an-existing-node-of-the-testnet"},"Get the genesis config from an existing node of the testnet"),(0,r.kt)("h1",{id:"jimmy-the-first-line-should-be-updated-to-curl-httpsprod-testnetprodfindoraorg26657genesis-"},"(@Jimmy: the first line should be updated to: 'curl ",(0,r.kt)("a",{parentName:"h1",href:"https://prod-testnet.prod.findora.org:26657/genesis"},"https://prod-testnet.prod.findora.org:26657/genesis")," \\')"),(0,r.kt)("p",null,"curl ",(0,r.kt)("a",{parentName:"p",href:"https://dev-qa01.dev.findora.org:26657/genesis"},"https://dev-qa01.dev.findora.org:26657/genesis"),' \\\n| jq -c \\\n| perl -pe \'s/^{"jsonrpc":"2.0","id":-1,"result":{"genesis"://\' \\\n| perl -pe \'s/}}$//\' \\\n| jq > ~/.tendermint/config/genesis.json'),(0,r.kt)("h1",{id:"adjust-the-block-interval"},"Adjust the block interval"),(0,r.kt)("p",null,"perl -pi -e 's#(create_empty_blocks_interval = ).*#$1\"15s\"#' ~/.tendermint/config/config.toml"),(0,r.kt)("h1",{id:"config-some-existing-nodes-to-your-locale-node"},"Config some existing nodes to your locale node,"),(0,r.kt)("h1",{id:"so-it-can-connect-to-the-testnet-by-them"},"so it can connect to the testnet by them"),(0,r.kt)("h1",{id:"jimmy-should-be-updated-to-the-co-reponding-sentry-nodes-of-testnet"},"(@Jimmy: should be updated to the co-reponding sentry nodes of testnet)"),(0,r.kt)("p",null,'perl -pi -e \'s#(persistent_peers = )".*"#$1"b87304454c0a0a0c5ed6c483ac5adc487f3b21f6\\@dev-qa01-us-west-2-sentry-000-public.dev.findora.org:26656,d0c6e3e1589695ae6d650b288caf2efe9a998a50\\@dev-qa01-us-west-2-sentry-001-public.dev.findora.org:26656"#\' ~/.tendermint/config/config.toml'),(0,r.kt)("h4",{id:"run-your-locale-node"},"Run your locale node"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# example:\n# rm -rf ${HOME}/findora_testnet\n# mkdir -p ${HOME}/findora_testnet/{abci, tendermint}\n\n# example:\n# cd ${HOME}/findora_testnet/abci || exit 1\ncd <The running path of your abci process>\nnohup abci_validator_node &\n\n# example:\n# cd ${HOME}/findora_testnet/tendermint || exit 1\ncd <The running path of your tendermint process>\nnohup tendermint node --db_backend=cleveldb &\n")),(0,r.kt)("h4",{id:"check-the-status-of-your-locale-node"},"Check the status of your locale node"),(0,r.kt)("p",null,"If the following commands can return useful message without error,\nit proves that your node is running well:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl 'http://localhost:8667/version'\ncurl 'http://localhost:8668/version'\ncurl 'http://localhost:8669/version'\ncurl 'http://localhost:26657/status'\n")),(0,r.kt)("h2",{id:"staking"},"Staking"),(0,r.kt)("p",null,"For staking operations, you should use the ",(0,r.kt)("inlineCode",{parentName:"p"},"fns")," tool."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Usage example:"),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("inlineCode",{parentName:"p"},"fns stake --help")),(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"USAGE:\n    fns stake [FLAGS] [OPTIONS] --amount <Amount>\n\nFLAGS:\n    -a, --append     stake more FRAs to your node\n\nOPTIONS:\n    -n, --amount <Amount>           how much `FRA unit`s you want to stake\n    -R, --commission-rate <Rate>    the commission rate for delegators, a float number from 0.0 to 1.0\n    -M, --validator-memo <Memo>     the description of your validator node, optional\n")),(0,r.kt)("p",{parentName:"blockquote"},"Similar help information can be obtained through the ",(0,r.kt)("inlineCode",{parentName:"p"},"fns")," tool itself:"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns stake --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns unstake --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns claim --help")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fns transfer --help")),(0,r.kt)("li",{parentName:"ul"},"..."))),(0,r.kt)("h3",{id:"stake-into-findora-network"},"Stake into findora network"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Tips"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"you should wait for 100% completion of the data synchronization of your node",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Or you may be punished by the network because of 'validator node offline'"))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# The minimal amount of FRAs for a successful staking is 888888\n# example:\n# - your want to stake 1888888 FRAs\n# - that is 1888888 * 1000000 FRA units\nfns stake -n $((1888888 * 1000000)) -R 0.2 -M 'Bob Node'\n")),(0,r.kt)("h3",{id:"append-more-power-to-your-node"},"Append more power to your node"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# append 2 FRA units to your node,\n# the power of your node will be increased by 2 if all is well\nfns stake -a -n 2\n")),(0,r.kt)("h3",{id:"query-infomations"},"Query infomations"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"fns show\n")),(0,r.kt)("h3",{id:"claim-rewards"},"Claim rewards"),(0,r.kt)("p",null,"Claim all your rewards:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns claim\n")),(0,r.kt)("p",null,"Claim part of your rewards:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# fns claim -n <the amount of FRA units you want>\n# example:\n# - your want to claim 10 FRAs\n# - that is 10 * 1000000 FRA units\nfns claim -n $((10 * 1000000))\n")),(0,r.kt)("h3",{id:"unstake-principals"},"Unstake principals"),(0,r.kt)("p",null,"Unstake all your principals:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"NOTE"),": this operation will make your node out of findora network.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"fns unstake\n")),(0,r.kt)("p",null,"Unstake part of your principals:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# fns unstake -n <the amount of FRA units you want>\n# example:\n# - your want to unstake 900 FRAs\n# - that is 900 * 1000000 FRA units\nfns unstake -n $((900 * 1000000))\n")))}c.isMDXComponent=!0}}]);